<!doctype html>
<html lang="en">
<head>

    <!-- Webpage Title -->
    <title>Home</title>

    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bulma CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.1/css/bulma.min.css">
    <!-- Font Awesome CSS -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <link href="{{ url_for('static', filename='mystyle.css') }}" rel="stylesheet">
    <!-- JS -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.js"></script>


    <script>
        function post() {
            let comment = $("#textarea-post").val()//띄운 모달에 입력한 값을 가져옴
            let can_num
            $.ajax({
                type: "POST",
                url: "/posting",
                data: {
                    comment_give: comment,
                    // cannum_give: can_num
                },
                success: function (response) {
                    $("#modal-post").removeClass("is-active") //모달을 닫음
                    window.location.reload()
                }
            })
        }

        function get_posts() {
            $("#post-box").empty()
            $.ajax({
                type: "GET",
                url: "/get_posts",
                data: {},
                success: function (response) {
                    if (response["result"] == "success") {
                        let posts = response["posts"]
                        for (let i = 0; i < posts.length; i++) {
                            let post = posts[i]
                            let html_temp = `<div class="box" id="${post["_id"]}">  #첫번쨰 div 필요한가?
                                        <article class="media">
                                            <div class="media-left">
                                                <a class="image is-64x64" href="/user/${post['username']}">
                                                    <img class="is-rounded" src="/static/${post['profile_pic_real']}"
                                                         alt="Image">
                                                </a>
                                            </div>
                                            <div class="media-content">
                                                <div class="content">
                                                    <p>
                                                        <strong>${post['username']}</strong>
                                                        <br>
                                                        ${post['comment']}
                                                    </p>
                                                </div>

                                            </div>
                                        </article>
                                    </div>`
                            $("#post-box").append(html_temp)
                        }
                    }
                }
            })
        }
        $(document).ready(function () {
            get_posts()
        })
    </script>

</head>
<body>
<nav class="navbar is-fixed-top is-white" role="navigation" aria-label="main navigation">
    <div class="navbar-brand">
        <a class="navbar-item" href="/">
            <strong class="is-sparta"
                    style="font-family: 'Stylish', sans-serif;font-size: larger;">20대 대선후보</strong>
        </a>
    </div>
</nav>
//포스팅 칸
<section class="section">
    <article class="media">
        <figure class="media-left" style="align-self: center">
        </figure>
        <div class="media-content">
            <div class="field">
                <p class="control">
                    <input id="input-post" class="input is-rounded" placeholder="댓글작성"
                           onclick='$("#modal-post").addClass("is-active")'></p>
            </div>
        </div>
    </article>
</section>
</body>
</html>